<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Chapter&nbsp;22.&nbsp;&#36890;&#29992;&#25480;&#26435;&#27010;&#24565;</title><link rel="stylesheet" href="html.css" tppabs="http://www.family168.com/tutorial/springsecurity/html/css/html.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.72.0"><link rel="start" href="springsecurity.html" title="Spring Security"><link rel="up" href="authorization.html" title="Part&nbsp;IV.&nbsp;&#25480;&#26435;"><link rel="prev" href="authorization.html" title="Part&nbsp;IV.&nbsp;&#25480;&#26435;"><link rel="next" href="secure-object-impls.html" title="Chapter&nbsp;23.&nbsp;&#23433;&#20840;&#23545;&#35937;&#23454;&#29616;"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="background-color:white;border:none;height:73px;border:1px solid black;"><a style="border:none;" href="javascript:if(confirm('http://static.springframework.org/spring-ws/site/  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='http://static.springframework.org/spring-ws/site/'" tppabs="http://static.springframework.org/spring-ws/site/" title="The Spring Framework - Spring Web Services"><img style="border:none;" src="xdev-spring_logo.jpg" tppabs="http://www.family168.com/tutorial/springsecurity/html/images/xdev-spring_logo.jpg"></a><a style="border:none;" href="javascript:if(confirm('http://www.springsource.com/  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='http://www.springsource.com/'" tppabs="http://www.springsource.com/" title="SpringSource"><img style="border:none;position:absolute;padding-top:5px;right:42px;" src="s2-banner-rhs.png" tppabs="http://www.family168.com/tutorial/springsecurity/html/images/s2-banner-rhs.png"></a></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h1 class="title"><a name="authorization-common"></a>&#36890;&#29992;&#25480;&#26435;&#27010;&#24565;</h1></div></div></div>
  

  <div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="authorities"></a>22.1.&nbsp;&#25480;&#26435;</h2></div></div></div>
    

    <p>&#22312;&#35748;&#35777;&#37096;&#20998;&#31616;&#30053;&#25552;&#36807;&#20102;&#65292;&#25152;&#26377;&#30340;<code class="literal">Authentication</code>&#23454;&#29616;&#38656;&#35201;&#20445;&#23384;&#22312;&#19968;&#20010;<code class="literal">GrantedAuthority</code>&#23545;&#35937;&#25968;&#32452;&#20013;&#12290;
    &#36825;&#23601;&#26159;&#36171;&#20104;&#32473;&#20027;&#20307;&#30340;&#26435;&#38480;&#12290;
    <code class="literal">GrantedAuthority</code>&#23545;&#35937;&#36890;&#36807;<code class="literal">AuthenticationManager</code>&#20445;&#23384;&#21040; <code class="literal">Authentication</code>&#23545;&#35937;&#37324;&#65292;&#28982;&#21518;&#20174;<code class="literal">AccessDecisionManager</code>&#35835;&#20986;&#26469;&#65292;&#36827;&#34892;&#25480;&#26435;&#21028;&#26029;&#12290;</p>

    <p><code class="literal">GrantedAuthority</code>&#26159;&#19968;&#20010;&#21482;&#26377;&#19968;&#20010;&#26041;&#27861;&#25509;&#21475;&#65306;
      </p><pre class="programlisting">
  String getAuthority();
    </pre><p>
    &#36825;&#20010;&#26041;&#27861;&#20801;&#35768; <code class="literal">AccessDecisionManager</code>&#33719;&#24471;&#19968;&#20010;&#31934;&#30830;&#30340; <code class="literal">String</code> &#26469;&#34920;&#31034; <code class="literal">GrantedAuthority</code>&#12290;
    &#36890;&#36807;&#36820;&#22238;&#30340;<code class="literal">String</code>&#65292;&#19968;&#20010;<code class="literal">GrantedAuthority</code>&#21487;&#20197;&#31616;&#21333;&#30340;&#29992;&#22823;&#22810;&#25968;<code class="literal">AccessDecisionManager</code>&#8220;&#35835;&#21462;&#8221;&#12290;
    &#22914;&#26524;<code class="literal">GrantedAuthority</code>&#19981;&#33021;&#34920;&#31034;&#20026;&#19968;&#20010;<code class="literal">String</code>&#65292;<code class="literal">GrantedAuthority</code>&#20250;&#34987;&#30475;&#20316;&#26159;&#8220;&#22797;&#26434;&#30340;&#8221;&#65292;&#28982;&#21518;&#36820;&#22238;<code class="literal">null</code>&#12290;</p>

    <p>&#19968;&#20010;&#8220;&#22797;&#26434;&#30340;&#8221; <code class="literal">GrantedAuthority</code> &#30340;&#20363;&#23376;&#20250;&#26159;&#20445;&#23384;&#20102;&#25805;&#20316;&#21015;&#34920;&#21644;&#25480;&#26435;&#20449;&#24687;&#24182;&#24212;&#29992;&#22312;&#19981;&#21516;&#30340;&#23458;&#25143;&#24080;&#21495;&#25968;&#20540;&#30340;&#19968;&#20010;&#23454;&#29616;&#12290;
    &#22914;&#26524;&#35201;&#26174;&#31034;&#36825;&#31181;&#22797;&#26434;&#30340;<code class="literal">GrantedAuthority</code>&#65292;&#25226;&#36716;&#25442;&#25104;<code class="literal">String</code>&#26159;&#38750;&#24120;&#22797;&#26434;&#30340;&#65292;<code class="literal">getAuthority()</code>&#26041;&#27861;&#30340;&#32467;&#26524;&#24212;&#35813;&#36820;&#22238;<code class="literal">null</code>&#12290;
    &#36825;&#20250;&#23637;&#31034;&#32473;&#20219;&#20309;<code class="literal">AccessDecisionManager</code>&#65292;&#23427;&#38656;&#35201;&#29305;&#21035;&#25903;&#25345;<code class="literal">GrantedAuthority</code>&#30340;&#23454;&#29616;&#65292;&#26469;&#20102;&#35299;&#23427;&#30340;&#20869;&#23481;&#12290;</p>

    <p>Spring Security&#21253;&#21547;&#19968;&#20010;&#20855;&#20307;&#30340; <code class="literal">GrantedAuthority</code> &#23454;&#29616;&#65292;<code class="literal">GrantedAuthorityImpl</code>&#12290;
    &#36825;&#20801;&#35768;&#20219;&#20309;&#29992;&#25143;&#25351;&#23450;&#30340;<code class="literal">String</code>&#36716;&#25442;&#25104;<code class="literal">GrantedAuthority</code>&#12290;
    &#25152;&#26377;<code class="literal">AuthenticationProvider</code>&#21253;&#21547;&#23433;&#20840;&#32467;&#26500;&#65292;&#23427;&#20351;&#29992;<code class="literal">GrantedAuthorityImpl</code>&#32452;&#35013;<code class="literal">Authentication</code>&#23545;&#35937;&#12290;</p>
  </div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="pre-invocation"></a>22.2.&nbsp;&#22788;&#29702;&#39044;&#35843;&#29992;</h2></div></div></div>
    
    <p>
      &#20687;&#25105;&#20204;&#22312;<a href="technical-overview.html#secure-objects" tppabs="http://www.family168.com/tutorial/springsecurity/html/technical-overview.html#secure-objects" title="5.4.&nbsp;&#23433;&#20840;&#23545;&#35937;">&#25216;&#26415;&#27010;&#36848;</a>&#19968;&#31456;&#30475;&#21040;&#30340;&#37027;&#26679;&#65292;Spring Security&#25552;&#20379;&#20102;&#19968;&#20123;&#25318;&#25130;&#22120;&#65292;&#26469;&#25511;&#21046;&#23545;&#23433;&#20840;&#23545;&#35937;&#30340;&#35775;&#38382;&#26435;&#38480;&#65292;&#20363;&#22914;&#26041;&#27861;&#35843;&#29992;&#25110;web&#35831;&#27714;&#12290;
      &#19968;&#20010;&#26159;&#21542;&#20801;&#35768;&#25191;&#34892;&#35843;&#29992;&#30340;&#39044;&#35843;&#29992;&#20915;&#23450;&#65292;&#26159;&#30001;<code class="interfacename">AccessDecisionManager</code>&#23454;&#29616;&#30340;&#12290;
    </p>

    <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d4e2492"></a>22.2.1.&nbsp;AccessDecisionManager</h3></div></div></div>
      
    <p>&#36825;&#20010; <code class="literal">AccessDecisionManager</code> &#34987;<code class="literal">AbstractSecurityInterceptor</code>&#35843;&#29992;&#65292;&#23427;&#29992;&#26469;&#20316;&#26368;&#32456;&#35775;&#38382;&#25511;&#21046;&#30340;&#20915;&#23450;&#12290;
    &#36825;&#20010;<code class="literal">AccessDecisionManager</code>&#25509;&#21475;&#21253;&#21547;&#19977;&#20010;&#26041;&#27861;&#65306;
      </p><pre class="programlisting">
 void decide(Authentication authentication, Object secureObject, ConfigAttributeDefinition config) throws AccessDeniedException;
 boolean supports(ConfigAttribute attribute);
 boolean supports(Class clazz);
      </pre><p>
    &#20174;&#31532;&#19968;&#20010;&#26041;&#27861;&#21487;&#20197;&#30475;&#20986;&#26469;&#65292;<code class="literal">AccessDecisionManager</code>&#20351;&#29992;&#26041;&#27861;&#21442;&#25968;&#20256;&#36882;&#25152;&#26377;&#20449;&#24687;&#65292;&#36825;&#22909;&#20687;&#22312;&#35748;&#35777;&#35780;&#20272;&#26102;&#36827;&#34892;&#20915;&#23450;&#12290;
    &#29305;&#21035;&#26159;&#65292;&#22312;&#30495;&#23454;&#30340;&#23433;&#20840;&#26041;&#27861;&#26399;&#26395;&#35843;&#29992;&#30340;&#26102;&#20505;&#65292;&#20256;&#36882;&#23433;&#20840;<code class="literal">Object</code>&#21551;&#29992;&#37027;&#20123;&#21442;&#25968;&#12290;
    &#27604;&#22914;&#65292;&#35753;&#25105;&#20204;&#20551;&#35774;&#23433;&#20840;&#23545;&#35937;&#26159;&#19968;&#20010;<code class="literal">MethodInvocation</code>&#12290;
    &#24456;&#23481;&#26131;&#20026;&#20219;&#20309;<code class="literal">Customer</code>&#21442;&#25968;&#26597;&#35810;<code class="literal">MethodInvocation</code>&#65292;&#65292;&#28982;&#21518;&#22312;<code class="literal">AccessDecisionManager</code>&#37324;&#23454;&#29616;&#19968;&#20123;&#26377;&#24207;&#30340;&#23433;&#20840;&#36923;&#36753;&#65292;&#26469;&#30830;&#35748;&#20027;&#20307;&#26159;&#21542;&#20801;&#35768;&#22312;&#37027;&#20010;&#23458;&#25143;&#19978;&#25805;&#20316;&#12290;
    &#22914;&#26524;&#35775;&#38382;&#34987;&#25298;&#32477;&#65292;&#23454;&#29616;&#23558;&#25243;&#20986;&#19968;&#20010;<code class="literal">AccessDeniedException</code>&#24322;&#24120;&#12290;</p>

    <p>&#36825;&#20010; <code class="literal">supports(ConfigAttribute)</code> &#26041;&#27861;&#22312;&#21551;&#21160;&#30340;&#26102;&#20505;&#34987;<code class="literal">AbstractSecurityInterceptor</code>&#35843;&#29992;&#65292;&#26469;&#20915;&#23450;<code class="literal">AccessDecisionManager</code>&#26159;&#21542;&#21487;&#20197;&#25191;&#34892;&#20256;&#36882;<code class="literal">ConfigAttribute</code>&#12290;
    <code class="literal">supports(Class)</code>&#26041;&#27861;&#34987;&#23433;&#20840;&#25318;&#25130;&#22120;&#23454;&#29616;&#35843;&#29992;&#65292;&#21253;&#21547;&#23433;&#20840;&#25318;&#25130;&#22120;&#23558;&#26174;&#31034;&#30340;<code class="literal">AccessDecisionManager</code>&#25903;&#25345;&#23433;&#20840;&#23545;&#35937;&#30340;&#31867;&#22411;&#12290;</p>

    <div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d4e2513"></a>22.2.1.1.&nbsp;&#22522;&#20110;&#25237;&#31080;&#30340;AccessDecisionManager&#23454;&#29616;</h4></div></div></div>
      
    <p>&#34429;&#28982;&#29992;&#25143;&#21487;&#20197;&#23454;&#29616;&#23427;&#33258;&#24049;&#30340;<code class="literal">AccessDecisionManager</code>&#26469;&#25511;&#21046;&#25152;&#26377;&#25480;&#26435;&#30340;&#26041;&#38754;&#65292;Spring Security&#21253;&#25324;&#24456;&#22810;&#22522;&#20110;&#25237;&#31080;&#30340;<code class="literal">AccessDecisionManager</code>&#23454;&#29616;&#12290;
    <a href="authorization-common.html#authz-access-voting" tppabs="http://www.family168.com/tutorial/springsecurity/html/authorization-common.html#authz-access-voting" title="Figure&nbsp;22.1.&nbsp;&#25237;&#31080;&#20915;&#35758;&#31649;&#29702;&#22120;">Figure&nbsp;22.1, &#8220;&#25237;&#31080;&#20915;&#35758;&#31649;&#29702;&#22120;&#8221;</a>&#26174;&#31034;&#26377;&#20851;&#30340;&#31867;&#12290;</p>
      <div class="figure"><a name="authz-access-voting"></a><div class="figure-contents">
        
      <div class="mediaobject" align="center"><img src="AccessDecisionVoting.gif" tppabs="http://www.family168.com/tutorial/springsecurity/html/images/AccessDecisionVoting.gif" align="middle" alt="&#25237;&#31080;&#20915;&#35758;&#31649;&#29702;&#22120;"></div>
      </div><p class="title"><b>Figure&nbsp;22.1.&nbsp;&#25237;&#31080;&#20915;&#35758;&#31649;&#29702;&#22120;</b></p></div><br class="figure-break">
    <p>&#20351;&#29992;&#36825;&#31181;&#26041;&#27861;&#65292;&#19968;&#31995;&#21015;&#30340; <code class="literal">AccessDecisionVoter</code> &#23454;&#29616;&#20026;&#25480;&#26435;&#20570;&#20915;&#23450;&#12290;
    &#36825;&#20010;<code class="literal">AccessDecisionManager</code>&#20250;&#20915;&#23450;&#26159;&#21542;&#22522;&#20110;&#23427;&#30340;&#25237;&#31080;&#35780;&#20272;&#25243;&#20986;<code class="literal">AccessDeniedException</code>&#24322;&#24120;&#12290;</p>

    <p> <code class="literal">AccessDecisionVoter</code> &#25509;&#21475;&#26377;&#19977;&#20010;&#26041;&#27861;&#65306;
</p><pre class="programlisting">
int vote(Authentication authentication, Object object, ConfigAttributeDefinition config);
boolean supports(ConfigAttribute attribute);
boolean supports(Class clazz);
</pre><p>
    &#20855;&#20307;&#23454;&#29616;&#36820;&#22238;&#19968;&#20010;<code class="literal">int</code>&#65292;&#20351;&#29992;&#21487;&#33021;&#30340;&#21453;&#26144;&#30340;<code class="literal">AccessDecisionVoter</code>&#38745;&#24577;&#23646;&#24615;<code class="literal">ACCESS_ABSTAIN</code>&#65292;<code class="literal">ACCESS_DENIED</code>&#21644;<code class="literal">ACCESS_GRANTED</code>&#12290;
    &#22914;&#26524;&#19968;&#20010;&#25237;&#31080;&#23454;&#29616;&#27809;&#26377;&#36873;&#25321;&#25480;&#26435;&#20915;&#23450;&#65292;&#20250;&#36820;&#22238;<code class="literal">ACCESS_ABSTAIN</code>&#12290;
    &#22914;&#26524;&#23427;&#36827;&#34892;&#36807;&#25225;&#25321;&#65292;&#23427;&#24517;&#39035;&#36820;&#22238;<code class="literal">ACCESS_DENIED</code>&#25110;<code class="literal">ACCESS_GRANTED</code>&#12290;</p>

    <p>&#36825;&#20799;&#26377;&#19977;&#20010;&#30001;Spring Security&#25552;&#20379;&#30340;&#20855;&#20307; <code class="literal">AccessDecisionManager</code>&#65292;&#21487;&#20197;&#36827;&#34892;&#25237;&#31080;&#12290;
    <code class="literal">ConsensusBased</code>&#23454;&#29616;&#20250;&#25480;&#26435;&#65292;&#25110;&#25298;&#32477;&#35775;&#38382;&#65292;&#22522;&#20110;&#27809;&#26377;&#25918;&#24323;&#30340;&#37027;&#20123;&#25237;&#31080;&#30340;&#20849;&#35782;&#12290;
    &#37027;&#20123;&#23646;&#24615;&#22312;&#24179;&#31561;&#25237;&#31080;&#26102;&#38388;&#19978;&#34987;&#25552;&#20379;&#26469;&#25511;&#21046;&#34892;&#20026;&#65292;&#25110;&#22914;&#26524;&#25152;&#26377;&#25237;&#31080;&#37117;&#26159;&#24323;&#26435;&#20102;&#12290;
    <code class="literal">AffirmativeBased</code>&#23454;&#29616;&#20250;&#25480;&#20104;&#35775;&#38382;&#26435;&#38480;&#65292;&#22914;&#26524;&#25910;&#21040;&#19968;&#20010;&#25110;&#22810;&#20010;<code class="literal">ACCESS_GRANTED</code>&#25237;&#31080;&#65288;&#27604;&#22914;&#65292;&#19968;&#20010;&#21453;&#23545;&#25237;&#31080;&#20250;&#34987;&#24573;&#30053;&#65292;&#22914;&#26524;&#36825;&#37324;&#33267;&#23569;&#26377;&#19968;&#20010;&#36190;&#25104;&#31080;&#65289;&#12290;
    &#20687;<code class="literal">ConsensusBased</code>&#23454;&#29616;&#19968;&#26679;&#65292;&#36825;&#37324;&#26377;&#19968;&#20010;&#21442;&#25968;&#25511;&#21046;&#22914;&#26524;&#25152;&#26377;&#25237;&#31080;&#37117;&#24323;&#26435;&#30340;&#34892;&#20026;&#12290;
    <code class="literal">UnanimousBased</code>&#25552;&#20379;&#22120;&#24076;&#26395;&#19968;&#33268;&#30340;<code class="literal">ACCESS_GRANTED</code>&#65292;&#26469;&#20801;&#35768;&#35775;&#38382;&#65292;&#24573;&#30053;&#24323;&#26435;&#12290;
    &#22914;&#26524;&#36825;&#37324;&#26377;&#20219;&#20309;&#19968;&#20010;<code class="literal">ACCESS_DENIED</code>&#25237;&#31080;&#65292;&#23427;&#20250;&#25298;&#32477;&#35775;&#38382;&#12290;
    &#20687;&#20854;&#20182;&#23454;&#29616;&#19968;&#26679;&#65292;&#26377;&#19968;&#20010;&#21442;&#25968;&#25511;&#21046;&#22914;&#26524;&#25152;&#26377;&#25237;&#31080;&#37117;&#24323;&#26435;&#30340;&#34892;&#20026;&#12290;</p>

    <p>&#26377;&#21487;&#33021;&#23454;&#29616;&#19968;&#20010;&#33258;&#23450;&#20041;&#30340;<code class="literal">AccessDecisionManager</code>&#36827;&#34892;&#19981;&#21516;&#30340;&#25237;&#31080;&#32479;&#35745;&#12290;
    &#27604;&#22914;&#65292;&#25237;&#31080;&#19968;&#20010;&#29305;&#23450;&#30340;<code class="literal">AccessDecisionVoter</code>&#21487;&#33021;&#33719;&#24471;&#26356;&#22810;&#30340;&#26435;&#37325;&#65292;&#36825;&#26679;&#19968;&#20010;&#25298;&#32477;&#31080;&#23545;&#29305;&#23450;&#30340;&#25237;&#31080;&#32773;&#21487;&#33021;&#26377;&#21542;&#20915;&#26435;&#30340;&#25928;&#26524;&#12290;</p>

    <div class="section" lang="en"><div class="titlepage"><div><div><h5 class="title"><a name="d4e2553"></a>22.2.1.1.1.&nbsp;<code class="classname">RoleVoter</code></h5></div></div></div>
      
      <p>
        Spring Security&#20013;&#26368;&#24120;&#29992;&#21040;&#30340;<code class="literal">AccessDecisionVoter</code>&#23454;&#29616;&#26159;&#31616;&#21333;&#30340;<code class="classname">RoleVoter</code>&#65292;&#23427;&#25226;&#31616;&#21333;&#30340;&#35282;&#33394;&#21517;&#31216;&#20316;&#20026;&#37197;&#32622;&#23646;&#24615;&#65292;&#22914;&#26524;&#29992;&#25143;&#20998;&#37197;&#20102;&#26576;&#20010;&#35282;&#33394;&#23601;&#34987;&#20801;&#35768;&#35775;&#38382;&#12290;</p>
      <p>&#22914;&#26524;&#26377;&#20219;&#20309;&#19968;&#20010;&#37197;&#32622;&#23646;&#24615;&#26159;&#20197;<code class="literal">ROLE_</code>&#24320;&#22836;&#30340;&#65292;&#23601;&#21487;&#20197;&#36827;&#34892;&#25237;&#31080;&#12290;
      &#22914;&#26524;<code class="literal">GrantedAuthority</code>&#36820;&#22238;&#30340;<code class="literal">String</code>&#20869;&#23481;&#65288;&#36890;&#36807;<code class="literal">getAuthority()</code>&#26041;&#27861;&#65289;&#65292;&#19982;&#19968;&#20010;&#25110;&#22810;&#20010;&#20197;<code class="literal">ROLE_</code>&#24320;&#22836;&#30340;<code class="literal">ConfigAttributes</code>&#23436;&#20840;&#30456;&#21516;&#30340;&#35805;&#65292;&#23601;&#34920;&#31034;&#20801;&#35768;&#35775;&#38382;&#12290;
      &#22914;&#26524;&#27809;&#26377;&#21305;&#37197;&#20219;&#20309;&#19968;&#20010;&#20197;<code class="literal">ROLE_</code>&#24320;&#22836;&#30340;<code class="literal">ConfigAttribute</code>&#65292;<code class="literal">RoleVoter</code>&#23601;&#20250;&#25298;&#32477;&#35775;&#38382;&#12290;
      &#22914;&#26524;&#27809;&#26377;&#20197;<code class="literal">ROLE_</code>&#24320;&#22836;&#30340;<code class="literal">ConfigAttribute</code>&#65292;&#25237;&#31080;&#32773;&#23601;&#20250;&#24323;&#26435;&#12290;
      <code class="literal">RoleVoter</code>&#22312;&#21305;&#37197;&#30340;&#26102;&#20505;&#26159;&#22823;&#23567;&#20889;&#25935;&#24863;&#30340;&#65292;&#36825;&#20063;&#21253;&#25324;&#23545; <code class="literal">ROLE_</code>&#36825;&#20010;&#21069;&#32512;&#12290;</p>
    </div>


      

      <div class="section" lang="en"><div class="titlepage"><div><div><h5 class="title"><a name="d4e2573"></a>22.2.1.1.2.&nbsp;Custom Voters</h5></div></div></div>
        
    <p>&#20063;&#21487;&#33021;&#23454;&#29616;&#19968;&#20010;&#33258;&#23450;&#20041;&#30340;<code class="literal">AccessDecisionVoter</code>&#12290;
    Spring Security&#30340;&#21333;&#20803;&#27979;&#35797;&#25552;&#20379;&#20102;&#24456;&#22810;&#20363;&#23376;&#65292;&#21253;&#25324;<code class="literal">ContactSecurityVoter</code>&#21644;<code class="literal">DenyVoter</code>&#12290;
    &#22914;&#26524;<code class="literal">CONTACT_OWNED_BY_CURRENT_USER</code>&#30340;<code class="literal">ConfigAttribute</code>&#27809;&#26377;&#25214;&#21040;&#65292;<code class="literal">ContactSecurityVoter</code>&#22312;&#25237;&#31080;&#20915;&#23450;&#30340;&#26102;&#20505;&#23601;&#20250;&#24323;&#26435;&#12290;
    &#22914;&#26524;&#25237;&#31080;&#65292;&#23427;&#36890;&#36807;<code class="literal">MethodInvocation</code>&#26469;&#30830;&#35748;<code class="literal">Contact</code>&#23545;&#35937;&#30340;&#20027;&#20307;&#65292;&#36825;&#26159;&#26041;&#27861;&#35843;&#29992;&#30340;&#20027;&#20307;&#12290;
    &#22914;&#26524;<code class="literal">Contact</code>&#20027;&#20307;&#21305;&#37197;<code class="literal">Authentication</code>&#23545;&#35937;&#20013;&#34920;&#29616;&#30340;&#20027;&#20307;&#65292;&#23427;&#23601;&#20250;&#25237;&#36190;&#25104;&#31080;&#12290;
    &#23427;&#21487;&#33021;&#23545;<code class="literal">Contact</code>&#20027;&#20307;&#26377;&#19968;&#20010;&#31616;&#21333;&#30340;&#27604;&#36739;&#65292;&#20351;&#29992;&#19968;&#20123;<code class="literal">Authentication</code>&#34920;&#29616;&#30340;<code class="literal">GrantedAuthority</code>&#12290;
    &#25152;&#26377;&#36825;&#20123;&#23545;&#24212;&#19981;&#22810;&#20960;&#34892;&#20195;&#30721;&#65292;&#28436;&#31034;&#25480;&#26435;&#27169;&#22411;&#30340;&#28789;&#27963;&#24615;&#12290;</p>
        </div>
    </div>
      </div>
  </div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="after-invocation"></a>22.3.&nbsp;&#22788;&#29702;&#21518;&#20915;&#23450;</h2></div></div></div>
    
    <p>&#34429;&#28982; <code class="literal">AccessDecisionManager</code> &#34987;<code class="literal">AbstractSecurityInterceptor</code>&#22312;&#25191;&#34892;&#23433;&#20840;&#26041;&#27861;&#35843;&#29992;&#20043;&#21069;&#35843;&#29992;&#65292;&#19968;&#20123;&#31243;&#24207;&#38656;&#35201;&#19968;&#20010;&#26041;&#27861;&#26469;&#20462;&#25913;&#23433;&#20840;&#23545;&#35937;&#35843;&#29992;&#36820;&#22238;&#30340;&#23545;&#35937;&#12290;
    &#34429;&#28982;&#20320;&#21487;&#20197;&#31616;&#21333;&#23454;&#29616;&#33258;&#24049;&#30340;AOP&#28041;&#21450;&#23454;&#29616;&#65292;Spring Security&#25552;&#20379;&#26377;&#35768;&#22810;&#20855;&#20307;&#23454;&#29616;&#26041;&#38754;&#35843;&#29992;&#65292;&#38598;&#25104;&#23427;&#30340;ACL&#21151;&#33021;&#12290;</p>

    <p><a href="authorization-common.html#authz-after-invocation" tppabs="http://www.family168.com/tutorial/springsecurity/html/authorization-common.html#authz-after-invocation" title="Figure&nbsp;22.2.&nbsp;&#21518;&#20915;&#23450;&#23454;&#29616;">Figure&nbsp;22.2, &#8220;&#21518;&#20915;&#23450;&#23454;&#29616;&#8221;</a> &#23637;&#31034;Spring Security&#30340; <code class="literal">AfterInvocationManager</code> &#21644;&#23427;&#30340;&#20855;&#20307;&#23454;&#29616;&#12290;

    </p><div class="figure"><a name="authz-after-invocation"></a><div class="figure-contents">
      
      <div class="mediaobject" align="center"><img src="AfterInvocation.gif" tppabs="http://www.family168.com/tutorial/springsecurity/html/images/AfterInvocation.gif" align="middle" alt="&#21518;&#20915;&#23450;&#23454;&#29616;"></div>

    </div><p class="title"><b>Figure&nbsp;22.2.&nbsp;&#21518;&#20915;&#23450;&#23454;&#29616;</b></p></div><p><br class="figure-break">
    </p>

    <p>&#23601;&#20687;Spring Security&#30340;&#20854;&#20182;&#24456;&#22810;&#37096;&#20998;&#19968;&#26679;&#65292;<code class="literal">AfterInvocationManager</code>&#26377;&#19968;&#20010;&#21333;&#29420;&#30340;&#20855;&#20307;&#23454;&#29616;&#65292;<code class="literal">AfterInvocationProviderManager</code>&#26377;<code class="literal">AfterInvocationProvider</code>&#21015;&#34920;&#12290;
    &#27599;&#20010;<code class="literal">AfterInvocationProvider</code>&#34987;&#20801;&#35768;&#20462;&#25913;&#36820;&#22238;&#23545;&#35937;&#65292;&#25110;&#25243;&#20986;<code class="literal">AccessDeniedException</code>&#24322;&#24120;&#12290;
    &#30830;&#23454;&#22810;&#20010;&#25552;&#20379;&#22120;&#21487;&#20197;&#20462;&#25913;&#23545;&#35937;&#65292;&#20316;&#20026;&#20043;&#21069;&#25552;&#20379;&#22120;&#30340;&#32467;&#26524;&#20256;&#36882;&#32473;&#38431;&#21015;&#30340;&#19979;&#19968;&#20010;&#12290;
    &#35753;&#25105;&#20204;&#29616;&#22312;&#32771;&#34385;&#25105;&#20204;&#30340;<code class="literal">AfterInvocationProvider</code>&#30340;ACL&#25552;&#37266;&#23454;&#29616;&#12290;</p>

    <p>&#35831;&#27880;&#24847;&#65292;&#22914;&#26524;&#20320;&#20351;&#29992; <code class="literal">AfterInvocationManager</code>&#65292;&#20320;&#23558;&#20381;&#28982;&#38656;&#35201;&#37197;&#32622;&#23646;&#24615;&#65292;&#35753;<code class="literal">MethodSecurityInterceptor</code>&#30340;<code class="literal">AccessDecisionManager</code>&#20801;&#35768;&#19968;&#20010;&#25805;&#20316;&#12290;
    &#22914;&#26524;&#20320;&#20351;&#29992;&#20856;&#22411;&#30340;Spring Security&#21253;&#21547;<code class="literal">AccessDecisionManager</code>&#23454;&#29616;&#65292;&#27809;&#26377;&#22312;&#29305;&#23450;&#30340;&#23433;&#20840;&#26041;&#27861;&#35843;&#29992;&#19978;&#37197;&#32622;&#23646;&#24615;&#23450;&#20041;&#65292;&#20250;&#23548;&#33268;<code class="literal">AccessDecisionVoter</code>&#24323;&#26435;&#12290;
    &#36825;&#37324;&#65292;&#22914;&#26524;<code class="literal">AccessDecisionManager</code>&#30340;"<code class="literal">allowIfAllAbstainDecisions</code>"&#23646;&#24615;&#26159;<code class="literal">false</code>&#65292;&#20250;&#25243;&#20986;&#19968;&#20010;<code class="literal">AccessDeniedException</code>&#24322;&#24120;&#12290;
    &#20320;&#21487;&#20197;&#36991;&#20813;&#36825;&#20010;&#28508;&#22312;&#30340;&#38382;&#39064;&#65292;&#20351;&#29992;(i)&#25226;"<code class="literal">allowIfAllAbstainDecisions</code>" &#35774;&#32622;&#20026;<code class="literal">true</code>&#65288;&#34429;&#28982;&#36890;&#24120;&#19981;&#24314;&#35758;&#36825;&#20040;&#20570;&#65289;&#65292;&#25110;&#32773;(ii)&#30452;&#25509;&#30830;&#20445;&#36825;&#37324;&#33267;&#23569;&#26377;&#19968;&#20010;&#37197;&#32622;&#23646;&#24615;&#65292;&#36825;&#26679;<code class="literal">AccessDecisionVoter</code>&#20250;&#25237;&#36190;&#25104;&#31080;&#12290;
    &#21518;&#32773;&#65288;&#25512;&#33616;&#65289;&#26041;&#27861;&#36890;&#24120;&#20351;&#29992;<code class="literal">ROLE_USER</code>&#25110;<code class="literal">ROLE_AUTHENTICATED</code>&#37197;&#32622;&#23646;&#24615;&#12290;</p>

    <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="after-invocation-acl-aware"></a>22.3.1.&nbsp;ACL&#25552;&#37266;&#21518;&#20915;&#35758;&#25552;&#20379;&#22120;</h3></div></div></div>

      <p>&#35831;&#27880;&#24847;&#65306;Acegi Security 1.0.3&#21253;&#21547;&#19968;&#20010;&#26032;ACL&#27169;&#22411;&#39044;&#35272;&#12290;
      &#26032;ACL&#27169;&#22411;&#29305;&#21035;&#37325;&#20889;&#20102;&#20197;&#21069;&#30340;ACl&#27169;&#22359;&#12290;
      &#26032;&#27169;&#22359;&#21487;&#20197;&#22312;<code class="literal">org.springframework.security.acls</code>&#21253;&#37324;&#25214;&#21040;&#65292;&#32769;ACL&#27169;&#22359;&#25918;&#22312;<code class="literal">org.springframework.security.acl</code>&#12290;
      &#25105;&#20204;&#25512;&#33616;&#29992;&#25143;&#32771;&#34385;&#27979;&#35797;&#19968;&#19979;&#26032;ACL&#27169;&#22359;&#65292;&#20351;&#29992;&#23427;&#24314;&#31435;&#31243;&#24207;&#12290;
      &#32769;ACL&#27169;&#22411;&#24212;&#35813;&#32771;&#34385;&#24223;&#24323;&#20102;&#65292;&#21487;&#33021;&#22312;&#26410;&#26469;&#29256;&#26412;&#20013;&#21024;&#38500;&#12290;
      &#19979;&#38754;&#30340;&#20449;&#24687;&#26159;&#20851;&#20110;&#26032;ACL&#21253;&#30340;&#65292;&#22240;&#27492;&#20063;&#26159;&#25512;&#33616;&#30340;&#12290;</p>

      <p>&#25105;&#20204;&#32463;&#24120;&#22312;&#26381;&#21153;&#23618;&#20889;&#30340;&#26041;&#27861;&#23601;&#20687;&#36825;&#26679;&#65306;</p>

      <pre class="programlisting">public Contact getById(Integer id);</pre>

      <p>&#24120;&#24120;&#65292;&#21482;&#26377;&#20027;&#20307;&#20801;&#35768;&#35835;&#21462;<code class="literal">Contact</code>&#65292;&#23601;&#24212;&#35813;&#20801;&#35768;&#33719;&#24471;&#23427;&#12290;
      &#22312;&#36825;&#24773;&#20917;&#65292;<code class="literal">AccessDecisionManager</code>&#26041;&#27861;&#30001;<code class="literal">AbstractSecurityInterceptor</code>&#25552;&#20379;&#23558;&#19981;&#22815;&#20102;&#12290;
      &#36825;&#26159;&#22240;&#20026;<code class="literal">Contact</code>&#30340;&#36523;&#20221;&#65292;&#22312;&#35843;&#29992;&#23433;&#20840;&#23545;&#35937;&#20043;&#21069;&#26159;&#23436;&#20840;&#26377;&#25928;&#22320;&#12290;
      <code class="literal">AclAfterInvocationProvider</code>&#25552;&#20379;&#20102;&#19968;&#20010;&#35299;&#20915;&#26041;&#27861;&#65292;&#20687;&#19979;&#38754;&#36825;&#26679;&#37197;&#32622;&#65306;
</p><pre class="programlisting">
&lt;bean id="afterAclRead"
   class="org.springframework.security.afterinvocation.AclEntryAfterInvocationProvider"&gt;
  &lt;constructor-arg ref="aclService"/&gt;
  &lt;constructor-arg&gt;
    &lt;list&gt;
      &lt;ref local="org.springframework.security.acls.domain.BasePermission.ADMINISTRATION"/&gt;
      &lt;ref local="org.springframework.security.acls.domain.BasePermission.READ"/&gt;
    &lt;/list&gt;
  &lt;/constructor-arg&gt;
&lt;/bean&gt;
</pre><p>
        &#22312;&#19978;&#38754;&#30340;&#20363;&#23376;&#37324;&#65292;<code class="literal">Contact</code>&#38656;&#35201;&#37325;&#26032;&#23457;&#26680;&#65292;&#24182;&#20256;&#36882;&#32473;<code class="literal">AclEntryAfterInvocationProvider</code>&#12290;
        &#25552;&#20379;&#22120;&#20250;&#25243;&#20986;<code class="literal">AccessDeniedException</code>&#24322;&#24120;&#65292;&#22914;&#26524;<code class="literal">requirePermission</code>&#21015;&#34920;&#30340;&#20854;&#20013;&#19968;&#20010;&#27809;&#26377;&#25918;&#22312;<code class="literal">Authentication</code>&#37324;&#12290;
        <code class="literal">AclEntryAfterInvocationProvider</code>&#26597;&#35810;<code class="literal">Acl</code> &#26381;&#21153;&#65292;&#20026;<code class="literal">Authentication</code>&#23545;&#24212;&#30340;&#39046;&#22495;&#23545;&#35937;&#20915;&#23450;&#24212;&#29992;ACL&#12290;</p>

      <p>&#19968;&#20010;&#31616;&#21333;&#30340; <code class="literal">AclEntryAfterInvocationProvider</code> &#26159; <code class="literal">AclEntryAfterInvocationCollectionFilteringProvider</code>&#12290;
      &#23427;&#29992;&#26469;&#20174;&#20027;&#20307;&#19981;&#20801;&#35768;&#35775;&#38382;&#30340;&#24773;&#20917;&#21024;&#38500;<code class="literal">Collection</code>&#25110;&#20803;&#32032;&#25968;&#25454;&#65292;&#12290;
      &#23427;&#27704;&#36828;&#19981;&#20250;&#25243;&#20986;<code class="literal">AccessDeniedException</code> - &#30452;&#25509;&#23433;&#38745;&#30340;&#21024;&#38500;&#19981;&#20801;&#35768;&#30340;&#20803;&#32032;&#12290;
      &#25552;&#20379;&#22120;&#22914;&#19979;&#37197;&#32622;&#65306;
</p><pre class="programlisting">
&lt;bean id="afterAclCollectionRead"
    class="org.springframework.security.afterinvocation.AclEntryAfterInvocationCollectionFilteringProvider"&gt;
  &lt;constructor-arg ref="aclService"/&gt;
  &lt;constructor-arg&gt;
    &lt;list&gt;
      &lt;ref local="org.springframework.security.acls.domain.BasePermission.ADMINISTRATION"/&gt;
      &lt;ref local="org.springframework.security.acls.domain.BasePermission.READ"/&gt;
    &lt;/list&gt;
  &lt;/constructor-arg&gt;
&lt;/bean&gt;
    </pre><p>
        &#20687;&#20320;&#21487;&#20197;&#24819;&#20687;&#30340;&#65292;&#36820;&#22238;&#30340;<code class="literal">Object</code>&#24517;&#39035;&#26159;&#35753;&#25552;&#20379;&#22120;&#21487;&#20197;&#25805;&#20316;&#30340;<code class="literal">Collection</code>&#25110;&#25968;&#32452;&#12290;
        &#22914;&#26524;<code class="literal">AclManager</code>&#20998;&#26512;<code class="literal">Authentication</code>&#27809;&#26377;&#33719;&#24471;&#19968;&#20010;&#38431;&#21015;&#20013;&#30340;<code class="literal">requirePermission</code>&#65292;&#23427;&#23601;&#20250;&#21024;&#38500;&#20803;&#32032;&#12290;</p>

      <p>Contacts&#23454;&#20363;&#31243;&#24207;&#28436;&#31034;&#36825;&#20004;&#20010; <code class="literal">AfterInvocationProvider</code>&#12290;</p>
    </div>

    <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="after-invocation-acl-aware-old"></a>22.3.2.&nbsp;ACL-Aware AfterInvocationProviders (&#32769; ACL &#27169;&#22359;)</h3></div></div></div>

      <p>&#35831;&#27880;&#24847;&#65306;Acegi Security 1.0.3&#21253;&#21547;&#19968;&#20010;&#26032;ACL&#27169;&#22411;&#39044;&#35272;&#12290;
      &#26032;ACL&#27169;&#22411;&#26174;&#33879;&#30340;&#37325;&#20889;&#20102;&#20197;&#21069;&#30340;ACl&#27169;&#22359;&#12290;
      &#26032;&#27169;&#22359;&#21487;&#20197;&#22312;<code class="literal">org.springframework.security.acls</code>&#21253;&#37324;&#25214;&#21040;&#65292;&#32769;ACL&#27169;&#22359;&#25918;&#22312;<code class="literal">org.springframework.security.acl</code>&#12290;
      &#25105;&#20204;&#25512;&#33616;&#29992;&#25143;&#32771;&#34385;&#27979;&#35797;&#19968;&#19979;&#26032;ACL&#27169;&#22359;&#65292;&#20351;&#29992;&#23427;&#24314;&#31435;&#31243;&#24207;&#12290;
      &#32769;ACL&#27169;&#22411;&#24212;&#35813;&#32771;&#34385;&#24223;&#24323;&#20102;&#65292;&#21487;&#33021;&#22312;&#26410;&#26469;&#29256;&#26412;&#20013;&#21024;&#38500;&#12290;</p>

      <p>&#24120;&#29992;&#26381;&#21153;&#23618;&#26041;&#27861;&#65292;&#25105;&#20204;&#25152;&#26377;&#20889;&#21040;&#19968;&#20010;&#29366;&#24577;&#25110;&#21478;&#19968;&#20010;&#20687;&#36825;&#26679;&#65306;</p>

      <pre class="programlisting">public Contact getById(Integer id);</pre>

      <p>&#24120;&#24120;&#65292;&#21482;&#26377;&#20027;&#20307;&#20801;&#35768;&#35835;&#21462;<code class="literal">Contact</code>&#65292;&#24212;&#35813;&#20801;&#35768;&#33719;&#24471;&#23427;&#12290;
      &#22312;&#36825;&#24773;&#20917;&#65292;<code class="literal">AccessDecisionManager</code>&#26041;&#27861;&#30001;<code class="literal">AbstractSecurityInterceptor</code>&#25552;&#20379;&#23558;&#19981;&#22815;&#20102;&#12290;
      &#36825;&#26159;&#22240;&#20026;<code class="literal">Contact</code>&#30340;&#36523;&#20221;&#65292;&#22312;&#35843;&#29992;&#23433;&#20840;&#23545;&#35937;&#20043;&#21069;&#26159;&#23436;&#20840;&#26377;&#25928;&#22320;&#12290;
      <code class="literal">AclAfterInvocationProvider</code>&#25552;&#20379;&#20102;&#19968;&#20010;&#35299;&#20915;&#26041;&#27861;&#65292;&#23427;&#20687;&#19979;&#38754;&#36825;&#26679;&#37197;&#32622;&#65306;</p>

      <pre class="programlisting">public Contact getById(Integer id);</pre>

      <p>&#24120;&#24120;&#65292;&#21482;&#26377;&#20027;&#20307;&#20801;&#35768;&#35835;&#21462;<code class="literal">Contact</code>&#65292;&#24212;&#35813;&#20801;&#35768;&#33719;&#24471;&#23427;&#12290;
      &#22312;&#36825;&#24773;&#20917;&#65292;<code class="literal">AccessDecisionManager</code>&#26041;&#27861;&#30001;<code class="literal">AbstractSecurityInterceptor</code>&#25552;&#20379;&#23558;&#19981;&#22815;&#20102;&#12290;
      &#36825;&#26159;&#22240;&#20026;<code class="literal">Contact</code>&#30340;&#36523;&#20221;&#65292;&#22312;&#35843;&#29992;&#23433;&#20840;&#23545;&#35937;&#20043;&#21069;&#26159;&#23436;&#20840;&#26377;&#25928;&#22320;&#12290;
      <code class="literal">AclAfterInvocationProvider</code>&#25552;&#20379;&#20102;&#19968;&#20010;&#35299;&#20915;&#26041;&#27861;&#65292;&#23427;&#20687;&#19979;&#38754;&#36825;&#26679;&#37197;&#32622;&#65306;

      </p><pre class="programlisting">
&lt;bean id="afterAclRead"
    class="org.springframework.security.afterinvocation.BasicAclEntryAfterInvocationProvider"&gt;
  &lt;property name="aclManager" ref="aclManager"/&gt;
  &lt;property name="requirePermission"&gt;
    &lt;list&gt;
      &lt;ref local="org.springframework.security.acl.basic.SimpleAclEntry.ADMINISTRATION"/&gt;
      &lt;ref local="org.springframework.security.acl.basic.SimpleAclEntry.READ"/&gt;
    &lt;/list&gt;
  &lt;/property&gt;
&lt;/bean&gt;
      </pre><p>

        &#22312;&#19978;&#38754;&#30340;&#20363;&#23376;&#37324;&#65292;<code class="literal">Contact</code>&#38656;&#35201;&#37325;&#26032;&#23457;&#26680;&#65292;&#24182;&#20256;&#36882;&#32473;<code class="literal">AclEntryAfterInvocationProvider</code>&#12290;
        &#25552;&#20379;&#22120;&#20250;&#25243;&#20986;<code class="literal">AccessDeniedException</code>&#24322;&#24120;&#65292;&#22914;&#26524;<code class="literal">requirePermission</code>&#21015;&#34920;&#30340;&#20854;&#20013;&#19968;&#20010;&#27809;&#26377;&#25918;&#22312;<code class="literal">Authentication</code>&#37324;&#12290;
        <code class="literal">AclEntryAfterInvocationProvider</code>&#26597;&#35810;<code class="literal">Acl</code> &#26381;&#21153;&#65292;&#20026;<code class="literal">Authentication</code>&#23545;&#24212;&#30340;&#39046;&#22495;&#23545;&#35937;&#20915;&#23450;&#24212;&#29992;ACL&#12290;</p>

      <p>&#19968;&#20010;&#31616;&#21333;&#30340; <code class="literal">AclEntryAfterInvocationProvider</code> &#26159; <code class="literal">AclEntryAfterInvocationCollectionFilteringProvider</code>&#12290;
      &#23427;&#29992;&#26469;&#20174;&#20027;&#20307;&#19981;&#20801;&#35768;&#35775;&#38382;&#30340;&#24773;&#20917;&#21024;&#38500;<code class="literal">Collection</code>&#25110;&#20803;&#32032;&#25968;&#25454;&#12290;
      &#23427;&#27704;&#36828;&#19981;&#20250;&#25243;&#20986;<code class="literal">AccessDeniedException</code> - &#30452;&#25509;&#23433;&#38745;&#30340;&#21024;&#38500;&#19981;&#20801;&#35768;&#30340;&#20803;&#32032;&#12290;
      &#25552;&#20379;&#22120;&#22914;&#19979;&#37197;&#32622;&#65306;
</p><pre class="programlisting">
&lt;bean id="afterAclCollectionRead"
    class="org.springframework.security.afterinvocation.BasicAclEntryAfterInvocationCollectionFilteringProvider"&gt;
  &lt;property name="aclManager" ref="aclManager"/&gt;
  &lt;property name="requirePermission"&gt;
    &lt;list&gt;
      &lt;ref local="org.springframework.security.acl.basic.SimpleAclEntry.ADMINISTRATION"/&gt;
      &lt;ref local="org.springframework.security.acl.basic.SimpleAclEntry.READ"/&gt;
    &lt;/list&gt;
  &lt;/property&gt;
&lt;/bean&gt;
</pre><p>
        &#20687;&#20320;&#21487;&#20197;&#24819;&#20687;&#30340;&#65292;&#36820;&#22238;&#30340;<code class="literal">Object</code>&#24517;&#39035;&#26159;<code class="literal">Collection</code>&#25110;&#25968;&#32452;&#65292;&#35753;&#25552;&#20379;&#22120;&#21487;&#20197;&#25805;&#20316;&#12290;
        &#23427;&#20250;&#21024;&#38500;&#20803;&#32032;&#65292;&#22914;&#26524;<code class="literal">AclManager</code>&#20998;&#26512;<code class="literal">Authentication</code>&#27809;&#26377;&#33719;&#24471;&#19968;&#20010;&#38431;&#21015;&#20013;&#30340;<code class="literal">requirePermission</code>&#12290;</p>

      <p>Contacts&#23454;&#20363;&#31243;&#24207;&#28436;&#31034;&#36825;&#20004;&#20010; <code class="literal">AfterInvocationProvider</code>&#12290;</p>
    </div>
  </div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="authorization-taglibs"></a>22.4.&nbsp;&#25480;&#26435;&#26631;&#31614;&#24211;</h2></div></div></div>


    <p><code class="literal">AuthorizeTag</code>&#29992;&#26469;&#21253;&#25324;&#20869;&#23481;&#65292;&#22914;&#26524;&#24403;&#21069;&#20027;&#20307;&#25317;&#26377;&#30830;&#23450;&#30340;<code class="literal">GrantedAuthority</code>&#12290;</p>

    <p>&#19979;&#38754;&#30340;JSP&#29255;&#27573;&#23637;&#31034;&#22914;&#20309;&#20351;&#29992; <code class="literal">AuthorizeTag</code>&#65306;</p>

    <pre class="programlisting">

&lt;security:authorize ifAllGranted="ROLE_SUPERVISOR"&gt;
&lt;td&gt;
  &lt;a href="del.htm?id=&lt;c:out value="${contact.id}"/&gt;"&gt;Del&lt;/a&gt;
&lt;/td&gt;
&lt;/security:authorize&gt;
</pre>

    <p>&#22914;&#26524;&#20027;&#20307;&#25317;&#26377;ROLE_SUPERVISOR&#26435;&#38480;&#65292;&#36825;&#20010;&#26631;&#31614;&#23601;&#20250;&#26174;&#31034;&#26631;&#31614;&#30340;&#20869;&#23481;A&#12290;</p>

    <p><code class="literal">security:authorize</code> &#26631;&#31614;&#22768;&#26126;&#19979;&#38754;&#30340;&#23646;&#24615;&#65306;</p>

    <div class="itemizedlist"><ul type="disc" compact><li>
          <p><code class="literal">ifAllGranted</code>&#65306;&#36825;&#20010;&#26631;&#31614;&#21015;&#20986;&#30340;&#25152;&#26377;&#35282;&#33394;&#24517;&#39035;&#25480;&#26435;&#65292;&#25165;&#33021;&#36755;&#20986;&#26631;&#31614;&#30340;&#20869;&#23481;&#12290;</p>
        </li><li>
          <p><code class="literal">ifAnyGranted</code>&#65306;&#20219;&#20309;&#19968;&#20010;&#36825;&#20010;&#26631;&#31614;&#21015;&#20986;&#30340;&#35282;&#33394;&#24517;&#39035;&#25480;&#26435;&#65292;&#25165;&#33021;&#36755;&#20986;&#26631;&#31614;&#30340;&#20869;&#23481;&#12290;</p>
        </li><li>
          <p><code class="literal">ifNotGranted</code>&#65306;&#36825;&#20010;&#26631;&#31614;&#21015;&#20986;&#30340;&#35282;&#33394;&#27809;&#26377;&#19968;&#20010;&#26159;&#25480;&#26435;&#30340;&#65292;&#25165;&#33021;&#36755;&#20986;&#26631;&#31614;&#30340;&#20869;&#23481;&#12290;</p>
        </li></ul></div>

    <p>&#20320;&#20250;&#27880;&#24847;&#21040;&#65292;&#27599;&#20010;&#23646;&#24615;&#20320;&#21487;&#20197;&#20351;&#29992;&#22810;&#20010;&#35282;&#33394;&#12290;
    &#31616;&#21333;&#20351;&#29992;&#36887;&#21495;&#26469;&#20998;&#38548;&#35282;&#33394;&#12290;
    &#36825;&#20010;<code class="literal">authorize</code>&#26631;&#31614;&#24573;&#30053;&#23646;&#24615;&#20043;&#38388;&#30340;&#31354;&#26684;&#12290;</p>

    <p>&#26631;&#31614;&#24211;&#36923;&#36753;&#21644;&#25152;&#26377;&#23427;&#30340;&#21442;&#25968;&#19968;&#36215;&#12290;
    &#36825;&#24847;&#21619;&#30528;&#22914;&#26524;&#20320;&#32467;&#21512;&#20004;&#20010;&#25110;&#22810;&#20010;&#23646;&#24615;&#65292;&#36825;&#20010;&#26631;&#31614;&#25152;&#26377;&#23646;&#24615;&#24517;&#39035;&#26159;true&#65292;&#25165;&#20250;&#36755;&#20986;&#20869;&#23481;&#12290;
    &#19981;&#35201;&#22312;<code class="literal">ifNotGranted="ROLE_SUPERVISOR"</code>&#21518;&#38754;&#28155;&#21152; <code class="literal">ifAllGranted="ROLE_SUPERVISOR"</code>&#65292;&#21542;&#21017;&#20320;&#20250;&#22855;&#24618;&#20026;&#20160;&#20040;&#24635;&#20063;&#30475;&#19981;&#21040;&#26631;&#31614;&#30340;&#20869;&#23481;&#12290;</p>

    <p>&#22914;&#26524;&#24819;&#35201;&#25152;&#26377;&#30340;&#23646;&#24615;&#37117;&#36820;&#22238;true&#65292;&#25480;&#26435;&#26631;&#31614;&#20801;&#35768;&#20320;&#21019;&#24314;&#26356;&#22797;&#26434;&#30340;&#25480;&#26435;&#22330;&#26223;&#12290;
    &#27604;&#22914;&#65292;&#20320;&#21487;&#20197;&#22768;&#26126;<code class="literal">ifAllGranted="ROLE_SUPERVISOR"</code>&#65292;&#24182;&#22312;&#21516;&#19968;&#20010;&#26631;&#31614;&#37324;&#20351;&#29992;<code class="literal">ifNotGranted="ROLE_NEWBIE_SUPERVISOR"</code>&#65292;&#21487;&#20197;&#38450;&#27490;&#26032;&#30340;&#36229;&#32423;&#29992;&#25143;&#30475;&#21040;&#26631;&#31614;&#20869;&#23481;&#12290;
    &#28982;&#32780;&#20320;&#26080;&#30097;&#21487;&#20197;&#30452;&#25509;&#20351;&#29992;<code class="literal">ifAllGranted="ROLE_EXPERIENCED_SUPERVISOR"</code>&#65292;&#32780;&#19981;&#26159;&#22312;&#20320;&#30340;&#35774;&#35745;&#37324;&#28155;&#21152;NOT&#26465;&#20214;&#12290;</p>

    <p>&#26368;&#21518;&#19968;&#20214;&#20107;&#65306;&#26631;&#31614;&#39564;&#35777;&#25480;&#26435;&#26377;&#29305;&#23450;&#30340;&#39034;&#24207;&#65306;&#39318;&#20808;&#26159;<code class="literal">ifNotGranted</code>&#65292;&#28982;&#21518;&#26159;<code class="literal">ifAllGranted</code>&#65292;&#26368;&#21518;&#26159;<code class="literal">if
    AnyGranted</code>&#12290;</p>

    <p><code class="literal">AccessControlListTag</code>&#29992;&#26469;&#21253;&#21547;&#20869;&#23481;&#65292;&#21028;&#26029;&#24403;&#21069;&#30340;&#20027;&#20307;&#26159;&#21542;&#26377;&#19968;&#20010;ACL&#26469;&#26174;&#31034;&#39046;&#22495;&#23545;&#35937;&#12290;</p>

    <p>&#19979;&#38754;&#30340;JSP&#29255;&#27573;&#65292;&#28436;&#31034;&#22914;&#20309;&#20351;&#29992; <code class="literal">AccessControlListTag</code>&#65306;
</p><pre class="programlisting">
&lt;security:accesscontrollist domainObject="${contact}" hasPermission="8,16"&gt;
&lt;td&gt;&lt;a href="&lt;c:url value="del.htm"&gt;&lt;c:param name="contactId" value="${contact.id}"/&gt;&lt;/c:url&gt;"&gt;Del&lt;/a&gt;&lt;/td&gt;
&lt;/security:accesscontrollist&gt;
</pre><p>
    &#36825;&#26631;&#31614;&#20250;&#23548;&#33268;&#26631;&#31614;&#20869;&#23481;&#26174;&#31034;&#20986;&#26469;&#65292;&#22914;&#26524;&#20027;&#20307;&#25317;&#26377;&#23545;&#20110;"contact"&#39046;&#22495;&#23545;&#35937;&#25480;&#26435;16&#25110;&#32773;&#25480;&#26435;1&#12290;
    &#36825;&#20010;&#25968;&#20540;&#20854;&#23454;&#26159;&#35777;&#20070;&#65292;&#20351;&#29992;<code class="literal">BasePermission</code>&#20301;&#25513;&#30721;&#12290;
    &#35831;&#21442;&#32771;&#21442;&#32771;&#25351;&#21335;&#30340;ACL&#37096;&#20998;&#65292;&#20102;&#35299;&#26356;&#22810;Spring Security&#30340;ACL&#30693;&#35782;&#12290;</p>

    <p><code class="literal">AclTag</code> &#26159;&#32769;ACL&#27169;&#22411;&#30340;&#19968;&#37096;&#20998;&#65292;&#24212;&#35813;&#32771;&#34385;&#24223;&#24323;&#12290;&#22240;&#20026;&#19968;&#20123;&#21382;&#21490;&#38382;&#39064;&#65292;&#23427;&#19982;<code class="literal">AccessControlListTag</code>&#30340;&#20316;&#29992;&#30456;&#21516;&#12290;</p>
  </div>
</div><div xmlns:fo="http://www.w3.org/1999/XSL/Format" class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="authorization.html" tppabs="http://www.family168.com/tutorial/springsecurity/html/authorization.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="springsecurity.html" tppabs="http://www.family168.com/tutorial/springsecurity/html/springsecurity.html">Home</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="secure-object-impls.html" tppabs="http://www.family168.com/tutorial/springsecurity/html/secure-object-impls.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Part&nbsp;IV.&nbsp;&#25480;&#26435;&nbsp;</td><td width="20%" align="center"><span style="color:white;font-size:90%;"><a href="javascript:if(confirm('http://www.springsource.com/  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='http://www.springsource.com/'" tppabs="http://www.springsource.com/" title="SpringSource">Sponsored by SpringSource
                                        </a></span></td><td width="40%" align="right" valign="top">&nbsp;Chapter&nbsp;23.&nbsp;&#23433;&#20840;&#23545;&#35937;&#23454;&#29616;</td></tr></table></div></body></html><script type="text/javascript">var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www./");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));</script><script type="text/javascript">var pageTracker = _gat._getTracker("UA-2857097-3");pageTracker._initData();pageTracker._trackPageview();</script>